var ERE_STRIPE=ERE_STRIPE||{};!function(o){"use strict";ERE_STRIPE={init:function(){this.setupForm()},setupForm:function(){var t=o(".ere-stripe-form");if(0!==t.length){var e=t.attr("id"),a=ere_stripe_vars[e],n=null,r=t.find(".ere-stripe-button");r.length&&(n=StripeCheckout.configure({key:a.key,token:function(e,a){o("<input>").attr({type:"hidden",name:"stripeToken",value:e.id}).appendTo(t),o("<input>").attr({type:"hidden",name:"stripeTokenType",value:e.type}).appendTo(t),e.email&&o("<input>").attr({type:"hidden",name:"stripeEmail",value:e.email}).appendTo(t),t.submit()}}),r.on("click",function(e){e.preventDefault(),n.open(a.params)})),window.addEventListener("popstate",function(){null!=n&&n.close()})}}},o(document).ready(function(){if(ERE_STRIPE.init(),"undefined"!=typeof ere_payment_vars){var t=ere_payment_vars.ajax_url,n=ere_payment_vars.processing_text;o("#ere_payment_listing").on("click",function(){var e=o("input[name='ere_payment_method']:checked").val(),a=o("input[name='ere_payment_for']:checked").val(),t=o("#ere_property_id").val();"paypal"==e?r(t,a):"stripe"==e?o("#ere_stripe_per_listing button").trigger("click"):"wire_transfer"==e&&i(t,a)}),o("#ere_upgrade_listing").on("click",function(){var e=o("input[name='ere_payment_method']:checked").val(),a=o("#ere_property_id").val();"paypal"==e?r(a,3):"stripe"==e?o("#ere_stripe_upgrade_listing button").trigger("click"):"wire_transfer"==e&&i(a,3)});var r=function(e,a){o.ajax({type:"post",url:t,data:{action:"ere_paypal_payment_per_listing_ajax",property_id:e,payment_for:a,ere_security_payment:o("#ere_security_payment").val()},beforeSend:function(){ERE.show_loading(n)},success:function(e){window.location.href=e}})},i=function(e,a){o.ajax({type:"POST",url:t,data:{action:"ere_wire_transfer_per_listing_ajax",property_id:e,payment_for:a,ere_security_payment:o("#ere_security_payment").val()},beforeSend:function(){ERE.show_loading(n)},success:function(e){window.location.href=e}})};o("#ere_payment_package").on("click",function(e){var a=o("input[name='ere_payment_method']:checked").val(),t=o("input[name='ere_package_id']").val();"paypal"==a?p(t):"stripe"==a?o("#ere_stripe_per_package button").trigger("click"):"wire_transfer"==a&&_(t)});var p=function(e){o.ajax({type:"POST",url:t,data:{action:"ere_paypal_payment_per_package_ajax",package_id:e,ere_security_payment:o("#ere_security_payment").val()},beforeSend:function(){ERE.show_loading(n)},success:function(e){window.location.href=e}})},_=function(e){o.ajax({type:"POST",url:t,data:{action:"ere_wire_transfer_per_package_ajax",package_id:e,ere_security_payment:o("#ere_security_payment").val()},beforeSend:function(){ERE.show_loading(n)},success:function(e){window.location.href=e}})};o("#ere_free_package").on("click",function(){var e=o("input[name='ere_package_id']").val();o.ajax({type:"POST",url:t,data:{action:"ere_free_package_ajax",package_id:e,ere_security_payment:o("#ere_security_payment").val()},beforeSend:function(){ERE.show_loading(n)},success:function(e){window.location.href=e}})})}})}(jQuery);