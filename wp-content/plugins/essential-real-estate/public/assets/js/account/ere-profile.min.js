(function(a){'use strict';a(document).ready(function(){if("undefined"!=typeof ere_profile_vars){var b=ere_profile_vars.ajax_url,c=ere_profile_vars.upload_nonce,d=ere_profile_vars.file_type_title,e=ere_profile_vars.ere_site_url,f=ere_profile_vars.confirm_become_agent_msg,g=ere_profile_vars.confirm_leave_agent_msg;a(".ere-update-profile").validate({ignore:":hidden",errorElement:"span",rules:{user_firstname:{required:!0},user_lastname:{required:!0},user_email:{required:!0},user_mobile_number:{required:!0}},messages:{user_firstname:"",user_lastname:"",user_email:"",user_mobile_number:""}}),a("#ere_update_profile").on("click",function(){var c=a(this),d=c.parents("form"),e=c.text();d.valid()&&a.ajax({type:"POST",url:b,dataType:"json",data:{action:"ere_update_profile_ajax",user_firstname:a("#user_firstname").val(),user_lastname:a("#user_lastname").val(),user_des:a("#user_des").val(),user_position:a("#user_position").val(),user_email:a("#user_email").val(),user_mobile_number:a("#user_mobile_number").val(),user_fax_number:a("#user_fax_number").val(),user_company:a("#user_company").val(),user_licenses:a("#user_licenses").val(),user_office_number:a("#user_office_number").val(),user_office_address:a("#user_office_address").val(),user_facebook_url:a("#user_facebook_url").val(),user_twitter_url:a("#user_twitter_url").val(),user_linkedin_url:a("#user_linkedin_url").val(),user_pinterest_url:a("#user_pinterest_url").val(),user_instagram_url:a("#user_instagram_url").val(),user_skype:a("#user_skype").val(),user_youtube_url:a("#user_youtube_url").val(),user_vimeo_url:a("#user_vimeo_url").val(),user_website_url:a("#user_website_url").val(),profile_pic:a("#profile-pic-id").val(),ere_security_update_profile:a("#ere_security_update_profile").val()},beforeSend:function(){ERE.show_loading()},success:function(a){ERE.close_loading(0),a.success?ERE.popup_alert("fa fa-check-square-o",e,a.message):ERE.popup_alert("fa fa-exclamation-triangle",e,a.message)},error:function(){ERE.close_loading(0)}})}),a(".ere-change-password").validate({errorElement:"span",rules:{oldpass:{required:!0},newpass:{required:!0,minlength:4},confirmpass:{required:!0}},messages:{oldpass:"",newpass:"",confirmpass:""}}),a("#ere_change_pass").on("click",function(){var c,d,f,g,h=a(this),i=h.parents("form"),j=h.text();d=a("#oldpass").val(),f=a("#newpass").val(),g=a("#confirmpass").val(),c=a("#ere_security_change_password").val(),i.valid()&&a.ajax({type:"POST",dataType:"json",url:b,data:{action:"ere_change_password_ajax",oldpass:d,newpass:f,confirmpass:g,ere_security_change_password:c},beforeSend:function(){ERE.show_loading()},success:function(a){a.success?window.location.href=e:(ERE.close_loading(0),ERE.popup_alert("fa fa-exclamation-triangle",j,a.message))},error:function(){ERE.close_loading(0)}})}),a("#ere_user_as_agent").on("click",function(){var c=a(this),d=c.text();ERE.confirm_dialog(d,f,function(){a.ajax({type:"post",url:b,dataType:"json",data:{action:"ere_register_user_as_agent_ajax",ere_security_become_agent:a("#ere_security_become_agent").val()},beforeSend:function(){ERE.show_loading()},success:function(a){a.success?(ERE.close_loading(0),ERE.popup_alert("fa fa-check-square-o",d,a.message),setTimeout(function(){window.location.reload()},3e3)):(ERE.close_loading(0),ERE.popup_alert("fa fa-exclamation-triangle",d,a.message))},error:function(){ERE.close_loading(0)}})})}),a("#ere_leave_agent").on("click",function(){var c=a(this),d=c.text();ERE.confirm_dialog(d,g,function(){a.ajax({type:"post",url:b,dataType:"json",data:{action:"ere_leave_agent_ajax",ere_security_leave_agent:a("#ere_security_leave_agent").val()},beforeSend:function(){ERE.show_loading()},success:function(a){a.success?window.location.reload():(ERE.show_loading(),ERE.popup_alert("fa fa-exclamation-triangle",d,a.message))},error:function(){ERE.show_loading()}})})});var h=new plupload.Uploader({browse_button:"ere_select_profile_image",file_data_name:"ere_upload_file",container:"ere_profile_plupload_container",multi_selection:!1,url:b+"?action=ere_profile_image_upload_ajax&nonce="+c,filters:{mime_types:[{title:d,extensions:"jpg,jpeg,gif,png"}],max_file_size:"2000kb",prevent_duplicates:!0}});h.init(),h.bind("FilesAdded",function(a,b){var c="";plupload.each(b,function(a){c+="<div id=\"holder-"+a.id+"\" class=\"profile-thumb\"></div>"}),document.getElementById("user-profile-img").innerHTML=c,a.refresh(),h.start()}),h.bind("UploadProgress",function(a,b){document.getElementById("holder-"+b.id).innerHTML="<span><i class=\"fa fa-spinner fa-spin\"></i></span>"}),h.bind("Error",function(a,b){document.getElementById("errors_log").innerHTML+="<br/>Error #"+b.code+": "+b.message}),h.bind("FileUploaded",function(b,c,d){var e=a.parseJSON(d.response);if(e.success){var f="<img src=\""+e.url+"\"/><input type=\"hidden\" class=\"profile-pic-id\" id=\"profile-pic-id\" name=\"profile-pic-id\" value=\""+e.attachment_id+"\"/>";document.getElementById("holder-"+c.id).innerHTML=f}}),a("#remove-profile-image").on("click",function(a){a.preventDefault(),document.getElementById("user-profile-img").innerHTML="<div class=\"profile-thumb\"></div>"})}})})(jQuery);